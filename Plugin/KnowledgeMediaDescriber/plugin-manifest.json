{
  "manifestVersion": "1.0.0",
  "name": "KnowledgeMediaDescriber",
  "version": "2.0.1",
  "displayName": "知识库多媒体超栈追踪器",
  "description": "基于已知 file:// 地址执行多媒体“超栈追踪”的一体化插件。可完成：媒体定位、SHA256哈希计算、侧车创建/更新（含描述与Tag写入）、以及在同一请求中将媒体与侧车复制/移动到指定日记本目录并即时刷新 filePath / mediaPath / relativePath / mediaHash。",
  "author": "System",
  "pluginType": "synchronous",
  "entryPoint": {
    "command": "node knowledge-media-describer.js",
    "timeout": 120000
  },
  "communication": {
    "protocol": "stdio"
  },
  "capabilities": {
    "invocationCommands": [
      {
        "command": "TraceKnowledgeMedia",
        "description": "功能: 通过一个已知的媒体 file:// 地址执行“超栈追踪”主流程。\n主流程包含两段，可一次性完成：\n1) 追踪并写侧车：解析媒体文件、校验类型、计算 SHA256 哈希，生成或更新 sidecar，并可写入 description / tags / presetName / generator / source。\n2) 入库同步(可选)：当提供 targetDiaryName 后，在同一请求内把媒体文件与侧车文件一起复制或移动到目标日记本目录，并即时刷新侧车中的 filePath、mediaPath、relativePath、mediaHash。\n\n参数:\n- mediaPath (字符串, 必需): 媒体文件地址，推荐 file:// 绝对路径。\n- description (字符串, 可选): 主动写入侧车描述。\n- tags (字符串或数组, 可选): 主动写入侧车 Tag。字符串可用逗号分隔。\n- presetName (字符串, 可选): 侧车预设名。\n- generator (字符串或数组, 可选): 侧车 generator 字段。\n- source (字符串, 可选): 侧车 source 字段。\n- targetDiaryName (字符串, 可选): 目标日记本名称（只写 name，不写路径）。插件会自动保存到 KNOWLEDGEBASE_ROOT_PATH/targetDiaryName 下。\n- targetFileName (字符串, 可选): 目标文件名（含扩展名）。仅在 relocateMode 为 copy 时有效，用于在复制时重命名。\n- relocateMode (字符串, 可选, 默认 copy): copy 或 move。\n- overwrite (布尔, 可选, 默认 false): 是否允许覆盖同名文件；false 时自动改名避免覆盖。\n\n调用格式(仅写侧车):\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」KnowledgeMediaDescriber「末」,\ncommand:「始」TraceKnowledgeMedia「末」,\nmediaPath:「始」file:///abs/path/IMG_1202.JPG「末」,\ndescription:「始」会议白板照片，核心结论已拍摄留档。「末」,\ntags:「始」会议,白板,记录「末」,\npresetName:「始」CognitoName01「末」\n<<<[END_TOOL_REQUEST]>>>\n\n调用格式(一次性：写侧车 + 复制到目标日记本并重命名):\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」KnowledgeMediaDescriber「末」,\ncommand:「始」TraceKnowledgeMedia「末」,\nmediaPath:「始」file:///abs/path/IMG_1202.JPG「末」,\ndescription:「始」项目A现场截图。「末」,\ntags:「始」项目A,现场,截图「末」,\ntargetDiaryName:「始」Nova「末」,\ntargetFileName:「始」ProjectA_Site_01.jpg「末」,\nrelocateMode:「始」copy「末」,\noverwrite:「始」false「末」\n<<<[END_TOOL_REQUEST]>>>\n\n调用格式(一次性：写侧车 + 移动到目标日记本):\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」KnowledgeMediaDescriber「末」,\ncommand:「始」TraceKnowledgeMedia「末」,\nmediaPath:「始」file:///abs/path/IMG_1202.JPG「末」,\ntargetDiaryName:「始」Nova「末」,\nrelocateMode:「始」move「末」,\noverwrite:「始」false「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "command": "UpdateSidecarParams",
        "description": "功能: 更改指定日记本中某个文件的侧车文件参数。\n\n参数:\n- diaryName (字符串, 必需): 日记本名称。\n- fileName (字符串, 必需): 媒体文件名（含扩展名）。\n- description (字符串, 可选): 更新描述。\n- tags (字符串或数组, 可选): 更新 Tag。\n- presetName (字符串, 可选): 更新预设名。\n- generator (字符串或数组, 可选): 更新 generator 字段。\n- source (字符串, 可选): 更新 source 字段。\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」KnowledgeMediaDescriber「末」,\ncommand:「始」UpdateSidecarParams「末」,\ndiaryName:「始」Nova「末」,\nfileName:「始」ProjectA_Site_01.jpg「末」,\ndescription:「始」更新后的描述内容「末」,\ntags:「始」新标签1,新标签2「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "command": "ListSidecars",
        "description": "功能: 列出指定日记本中的侧车文件。\n\n参数:\n- diaryName (字符串, 必需): 日记本名称。\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」KnowledgeMediaDescriber「末」,\ncommand:「始」ListSidecars「末」,\ndiaryName:「始」Nova「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "command": "GetSidecar",
        "description": "功能: 查看指定日记本中某个文件的侧车文件内容。\n\n参数:\n- diaryName (字符串, 必需): 日记本名称。\n- fileName (字符串, 必需): 媒体文件名（含扩展名）。\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」KnowledgeMediaDescriber「末」,\ncommand:「始」GetSidecar「末」,\ndiaryName:「始」Nova「末」,\nfileName:「始」ProjectA_Site_01.jpg「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "command": "ReadFile",
        "description": "功能: 读取指定日记本中的指定文件内容（同 FileOperator 的 ReadFile 语义，默认不设大小限制）。\n参数:\n- diaryName (字符串, 必需): 日记本名称。\n- fileName (字符串, 必需): 文件名（含扩展名）。\n- encoding (字符串, 可选, 默认 utf8): 文本读取编码。\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」KnowledgeMediaDescriber「末」,\ncommand:「始」ReadFile「末」,\ndiaryName:「始」Nova「末」,\nfileName:「始」notes.txt「末」,\nencoding:「始」utf8「末」\n<<<[END_TOOL_REQUEST]>>>"
      },
      {
        "command": "RenameDiaryMedia",
        "description": "功能: 重命名指定日记本中的指定多模态文件，并联动重命名对应侧车文件，同时刷新侧车中的 filePath / mediaPath / relativePath / mediaHash。\n参数:\n- diaryName (字符串, 必需): 日记本名称。\n- fileName (字符串, 必需): 原媒体文件名（含扩展名）。\n- newFileName (字符串, 必需): 新媒体文件名（含扩展名）。\n- overwrite (布尔, 可选, 默认 false): 是否允许覆盖同名文件；false 时自动改名避免覆盖。\n\n调用格式:\n<<<[TOOL_REQUEST]>>>\ntool_name:「始」KnowledgeMediaDescriber「末」,\ncommand:「始」RenameDiaryMedia「末」,\ndiaryName:「始」Nova「末」,\nfileName:「始」ProjectA_Site_01.jpg「末」,\nnewFileName:「始」ProjectA_Site_Final.jpg「末」,\noverwrite:「始」false「末」\n<<<[END_TOOL_REQUEST]>>>"
      }
    ]
  },
  "configSchema": {
    "KNOWLEDGEBASE_ROOT_PATH": "string",
    "MULTIMODAL_SIDECAR_SUFFIX": "string",
    "DebugMode": "boolean"
  }
}