{
  "manifestVersion": "2.0",
  "name": "DiscourseReader",
  "displayName": "Discourse 论坛阅读器",
  "version": "1.5.1",
  "description": "让 AI Agent 高效阅读任意 Discourse 论坛内容。支持浏览帖子、读取正文与回复、搜索、板块列表、标签列表。通过 Discourse User API Key（RSA 握手协议）进行永久认证，Puppeteer + stealth 穿透 Cloudflare。",
  "author": "Rosa",
  "pluginType": "synchronous",
  "entryPoint": {
    "command": "node",
    "args": ["DiscourseReader.js"]
  },
  "communication": {
    "protocol": "stdio",
    "timeout": 60000
  },
  "configSchema": [
    {
      "key": "DISCOURSE_BASE_URL",
      "type": "string",
      "description": "默认 Discourse 论坛地址（如 https://linux.do）",
      "default": "https://linux.do"
    },
    {
      "key": "DEFAULT_CATEGORY",
      "type": "string",
      "description": "ListTopics 默认板块 slug",
      "default": "develop"
    },
    {
      "key": "forum_{name}_api_key",
      "type": "string",
      "description": "论坛 User API Key。{name} 按域名匹配（如 forum_linuxdo_api_key 匹配 linux.do）。获取方式：python get_user_api_key.py <论坛地址>"
    },
    {
      "key": "forum_{name}_cookie",
      "type": "string",
      "description": "备选认证：浏览器原始 cookie 字符串。配了 API Key 时优先使用 API Key"
    },
    {
      "key": "MAX_CONTENT_LENGTH",
      "type": "number",
      "description": "帖子内容最大字符数，超过则截断",
      "default": 3000
    },
    {
      "key": "MAX_POSTS",
      "type": "number",
      "description": "ReadTopic 默认最大返回楼层数",
      "default": 10
    }
  ],
  "capabilities": {
    "invocationCommands": [
      {
        "command": "ListTopics",
        "description": "浏览帖子列表。支持板块/标签筛选、分页、排序",
        "example": "command=ListTopics, category=develop, page=0, order=latest"
      },
      {
        "command": "ReadTopic",
        "description": "读取帖子正文与回复。支持按楼层分页",
        "example": "command=ReadTopic, topic_id=12345, max_posts=10, post_number=1"
      },
      {
        "command": "SearchForum",
        "description": "搜索论坛帖子。支持板块筛选、按相关度/时间/点赞排序",
        "example": "command=SearchForum, keyword=AI agent, category=develop"
      },
      {
        "command": "ListCategories",
        "description": "列出论坛所有板块及帖子/回复统计",
        "example": "command=ListCategories"
      },
      {
        "command": "ListTags",
        "description": "列出论坛所有标签，按帖子数降序",
        "example": "command=ListTags"
      }
    ]
  }
}