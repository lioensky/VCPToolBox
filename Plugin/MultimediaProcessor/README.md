
# MultimediaProcessor æ’ä»¶ (å¤šåª’ä½“é¢„è®¾å¤„ç†å™¨)

è¿™æ˜¯ä¸€ä¸ªå¼ºå¤§çš„ `messagePreprocessor` ç±»å‹æ’ä»¶ï¼Œæ”¯æŒåŸºäºè‡ªå®šä¹‰é¢„è®¾å¤„ç†å¤šåª’ä½“æ•°æ®ï¼ˆå›¾åƒã€éŸ³é¢‘ã€è§†é¢‘ï¼‰ï¼Œæä¾›é¢„è®¾ç»„åˆã€ç¼“å­˜å¤ç”¨ã€æ–‡ä»¶å¤¹æ‰¹é‡å¤„ç†å’Œè·¯å¾„åˆ«åç­‰é«˜çº§åŠŸèƒ½ã€‚

## æ ¸å¿ƒåŠŸèƒ½

### 1. è‡ªå®šä¹‰é¢„è®¾ç³»ç»Ÿ
- æ”¯æŒåˆ›å»ºå¤šä¸ªå‘½åé¢„è®¾ï¼Œæ¯ä¸ªé¢„è®¾åŒ…å«ç‹¬ç«‹çš„ promptã€maxTokens å’Œ thinkingBudget é…ç½®
- é¢„è®¾å¯ä»¥ç»„åˆä½¿ç”¨ï¼Œæœ€å¤šæ”¯æŒ 5 ä¸ªé¢„è®¾åŒæ—¶åº”ç”¨
- é¢„è®¾ä¹‹é—´ä½¿ç”¨åˆ†å· `;` åˆ†éš”

### 2. æ™ºèƒ½ç¼“å­˜æœºåˆ¶
- åŸºäºæ–‡ä»¶å†…å®¹çš„ MD5 å“ˆå¸Œå’Œé¢„è®¾åç§°å»ºç«‹ç¼“å­˜é”®
- **é»˜è®¤å¯ç”¨ç¼“å­˜**ï¼ŒèŠ‚çœ API æˆæœ¬å’Œå“åº”æ—¶é—´
- æ”¯æŒ `::no_cache` è¯­æ³•ç¦ç”¨ç¼“å­˜ï¼Œå¼ºåˆ¶é‡æ–°åˆ†æ
- ç¼“å­˜æ–‡ä»¶è‡ªåŠ¨ç®¡ç†ï¼Œæ”¯æŒæŒä¹…åŒ–å­˜å‚¨

### 3. è·¯å¾„å¤„ç†èƒ½åŠ›
- **æ”¯æŒç»å¯¹è·¯å¾„**: ç›´æ¥ä½¿ç”¨æ–‡ä»¶ç³»ç»Ÿçš„å®Œæ•´è·¯å¾„
- **æ”¯æŒç›¸å¯¹è·¯å¾„**: ç›¸å¯¹äºæ’ä»¶ç›®å½•çš„è·¯å¾„
- **æ”¯æŒè·¯å¾„åˆ«å**: åœ¨ `path-aliases.json` ä¸­å®šä¹‰åˆ«åæ˜ å°„
- **æ”¯æŒæ–‡ä»¶å¤¹è·¯å¾„**: è‡ªåŠ¨æ‰«ææ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰åª’ä½“æ–‡ä»¶
- **æ”¯æŒæ·±å±‚è·¯å¾„**: åˆ«åè·¯å¾„åå¯ä»¥æ·»åŠ å­ç›®å½•ï¼Œå¦‚ `images/subfolder/deeper`

### 4. æ‰¹é‡å¤„ç†ä¸è¿‡æ»¤
- å•ä¸ªè¯­æ³•å¯ä»¥å¤„ç†æ•´ä¸ªæ–‡ä»¶å¤¹çš„åª’ä½“æ–‡ä»¶
- æ”¯æŒå¼‚æ­¥å¹¶å‘å¤„ç†ï¼Œå¯é…ç½®å¹¶å‘æ•°é‡
- **ç™½åå•æœºåˆ¶**ï¼šé€šè¿‡é…ç½® `SupportedMediaFormats` æŒ‡å®šæ”¯æŒçš„æ ¼å¼
- **é»‘åå•æœºåˆ¶**ï¼šåœ¨æ–‡ä»¶å¤¹ä¸­æ”¾ç½® `.overbase64ignore` æ–‡ä»¶æ’é™¤ç‰¹å®šæ–‡ä»¶
- è‡ªåŠ¨è¯†åˆ«å¹¶è¿‡æ»¤æ–‡ä»¶ï¼Œåªå¤„ç†ç¬¦åˆæ¡ä»¶çš„åª’ä½“

## è¯­æ³•æ ¼å¼

### åŸºæœ¬è¯­æ³•
```
{{OverBase64::PresetName::filePath}}
```

### å¤šé¢„è®¾ç»„åˆ
```
{{OverBase64::PresetName01;PresetName02::filePath}}
{{OverBase64::PresetName01;PresetName02;PresetName03::filePath}}
```

### ç¦ç”¨ç¼“å­˜ï¼ˆå¼ºåˆ¶é‡æ–°åˆ†æï¼‰
```
{{OverBase64::PresetName::filePath::no_cache}}
{{OverBase64::PresetName01;PresetName02::filePath::no_cache}}
```

**æ³¨æ„**ï¼šé»˜è®¤è¡Œä¸ºæ˜¯ä½¿ç”¨ç¼“å­˜ï¼Œåªæœ‰æ˜ç¡®æ·»åŠ  `::no_cache` æ‰ä¼šç¦ç”¨ã€‚

### è·¯å¾„ç±»å‹ç¤ºä¾‹

#### 1. ç»å¯¹è·¯å¾„
```
{{OverBase64::detailed::/Users/username/Pictures/photo.jpg}}
{{OverBase64::technical::/home/user/videos/clip.mp4}}
{{OverBase64::detailed::C:\Users\Name\Images\photo.png}}
```

#### 2. è·¯å¾„åˆ«å
```
{{OverBase64::detailed::images}}
{{OverBase64::technical::videos/project1}}
{{OverBase64::emotional::downloads/photo.jpg}}
```

#### 3. æ–‡ä»¶å¤¹æ‰¹é‡å¤„ç†
```
{{OverBase64::detailed::/path/to/folder}}
{{OverBase64::detailed::images/vacation}}
{{OverBase64::summary;technical::downloads::cache}}
```

#### 4. æ··åˆä½¿ç”¨ç¤ºä¾‹
```
ç³»ç»Ÿæç¤ºè¯ä¸­ï¼š
è¯·åˆ†æè¿™äº›å›¾ç‰‡ï¼š
{{OverBase64::detailed::images/project}}
{{OverBase64::technical;emotional::downloads/screenshot.png::cache}}
{{OverBase64::summary::videos}}
```

## é…ç½®æ–‡ä»¶

### 1. presets.json
å®šä¹‰é¢„è®¾é…ç½®ï¼Œæ”¯æŒè‡ªå®šä¹‰ prompt å’Œæ¨¡å‹å‚æ•°ï¼š

```json
{
  "detailed": {
    "displayName": "è¯¦ç»†æè¿°é¢„è®¾",
    "prompt": "è¯·è¯¦ç»†æè¿°è¿™ä¸ªå¤šåª’ä½“å†…å®¹ï¼ŒåŒ…æ‹¬ä¸»è¦å…ƒç´ ã€é¢œè‰²ã€æ„å›¾ã€æ°›å›´ç­‰æ‰€æœ‰ç»†èŠ‚ã€‚",
    "model": "",
    "maxTokens": 2000,
    "temperature": 0.7,
    "topP": 1.0,
    "thinkingBudget": 0
  },
  "technical": {
    "displayName": "æŠ€æœ¯åˆ†æé¢„è®¾",
    "prompt": "ä»æŠ€æœ¯è§’åº¦åˆ†æè¿™ä¸ªå¤šåª’ä½“å†…å®¹ï¼šåˆ†è¾¨ç‡ã€è´¨é‡ã€æ ¼å¼ç‰¹å¾ã€æŠ€æœ¯ç»†èŠ‚ç­‰ã€‚",
    "model": "gpt-4-vision-preview",
    "maxTokens": 1500,
    "temperature": 0.3,
    "topP": 0.9,
    "thinkingBudget": 0
  },
  "creative": {
    "displayName": "åˆ›æ„æè¿°é¢„è®¾",
    "prompt": "ç”¨å¯Œæœ‰åˆ›æ„å’Œæƒ³è±¡åŠ›çš„è¯­è¨€æè¿°è¿™ä¸ªå†…å®¹ï¼Œå¯ä»¥ä½¿ç”¨æ¯”å–»å’Œä¿®è¾æ‰‹æ³•ã€‚",
    "model": "claude-3-opus-20240229",
    "maxTokens": 1500,
    "temperature": 1.0,
    "topP": 0.95,
    "thinkingBudget": 0
  },
  "precise": {
    "displayName": "ç²¾ç¡®åˆ†æé¢„è®¾",
    "prompt": "ä»¥æœ€ç²¾ç¡®å’Œå®¢è§‚çš„æ–¹å¼æè¿°è¿™ä¸ªå†…å®¹ï¼Œåªé™ˆè¿°å¯è§‚å¯Ÿçš„äº‹å®ã€‚",
    "model": "gpt-4-vision-preview",
    "maxTokens": 1200,
    "temperature": 0.1,
    "topP": 0.8,
    "thinkingBudget": 0
  }
}
```

**é¢„è®¾å‚æ•°è¯´æ˜ï¼š**

| å‚æ•° | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|-----|------|------|--------|
| `displayName` | string | é¢„è®¾çš„æ˜¾ç¤ºåç§° | å¿…éœ€ |
| `prompt` | string | å‘é€ç»™æ¨¡å‹çš„æç¤ºè¯ | å¿…éœ€ |
| `model` | string | ä½¿ç”¨çš„æ¨¡å‹åç§°ï¼Œç©ºå­—ç¬¦ä¸²åˆ™ä½¿ç”¨å…¨å±€é…ç½® | "" |
| `maxTokens` | integer | æœ€å¤§è¾“å‡º token æ•° | 2000 |
| `temperature` | float | æ¸©åº¦å‚æ•° (0.0-2.0)ï¼Œæ§åˆ¶è¾“å‡ºéšæœºæ€§ | 0.7 |
| `topP` | float | Top-P é‡‡æ ·å‚æ•° (0.0-1.0) | 1.0 |
| `thinkingBudget` | integer | æ€è€ƒé¢„ç®—ï¼ˆæ”¯æŒçš„æ¨¡å‹ï¼‰ | 0 |

**æ¸©åº¦å‚æ•°ä½¿ç”¨å»ºè®®ï¼š**
- `0.1-0.3`: ç²¾ç¡®ã€å®¢è§‚çš„åˆ†æï¼ˆæŠ€æœ¯æ–‡æ¡£ã€æ•°æ®åˆ†æï¼‰
- `0.5-0.7`: å¹³è¡¡çš„æè¿°ï¼ˆé€šç”¨åœºæ™¯ï¼‰
- `0.8-1.0`: åˆ›æ„ã€å¤šæ ·çš„è¾“å‡ºï¼ˆåˆ›æ„å†™ä½œã€è¥é”€æ–‡æ¡ˆï¼‰
- `1.0-2.0`: æå…·åˆ›æ„å’Œéšæœºæ€§ï¼ˆå®éªŒæ€§ç”¨é€”ï¼‰

**æ¨¡å‹é€‰æ‹©å»ºè®®ï¼š**
- `gpt-4-vision-preview`: å¼ºå¤§çš„è§†è§‰ç†è§£èƒ½åŠ›
- `gpt-4o`: æ›´å¿«çš„å“åº”é€Ÿåº¦
- `claude-3-opus`: åˆ›æ„å†™ä½œå’Œæ·±åº¦åˆ†æ
- `claude-3-sonnet`: å¹³è¡¡æ€§èƒ½å’Œæˆæœ¬
- ç©ºå­—ç¬¦ä¸² `""`: ä½¿ç”¨å…¨å±€é…ç½®çš„æ¨¡å‹

### 2. path-aliases.json
å®šä¹‰è·¯å¾„åˆ«åæ˜ å°„ï¼š

```json
{
  "images": "/Users/username/Pictures",
  "videos": "/Users/username/Videos",
  "downloads": "/Users/username/Downloads",
  "media": "/mnt/media",
  "project": "/path/to/project/assets"
}
```

### 3. config.env
æ’ä»¶ç‰¹å®šé…ç½®ï¼ˆå¯é€‰ï¼Œä¸è®¾ç½®åˆ™ä½¿ç”¨å…¨å±€é…ç½®ï¼‰ï¼š

```env
API_URL=https://api.openai.com
API_Key=your_api_key_here
MultiModalModel=gpt-4-vision-preview
MultiModalModelOutputMaxTokens=2000
MultiModalModelThinkingBudget=0
MultiModalModelAsynchronousLimit=3
DebugMode=false
```

## å®Œæ•´ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1: å•æ–‡ä»¶è¯¦ç»†åˆ†æ
```
ç”¨æˆ·æ¶ˆæ¯: 
è¯·å¸®æˆ‘åˆ†æè¿™å¼ å›¾ç‰‡
{{OverBase64::detailed::/Users/me/Pictures/sunset.jpg}}
```

è¾“å‡º:
```
[å¤šåª’ä½“å†…å®¹åˆ†æç»“æœ]

æ–‡ä»¶: sunset.jpg
  [detailed]: è¿™æ˜¯ä¸€å¼ ç¾ä¸½çš„æ—¥è½ç…§ç‰‡ã€‚ç”»é¢ä¸­ï¼Œæ©˜çº¢è‰²çš„å¤ªé˜³æ­£ç¼“ç¼“æ²‰å…¥åœ°å¹³çº¿...
```

### ç¤ºä¾‹ 2: å¤šé¢„è®¾ç»„åˆåˆ†æ
```
ç³»ç»Ÿæç¤ºè¯:
åˆ†æä»¥ä¸‹å›¾ç‰‡çš„æŠ€æœ¯è´¨é‡å’Œæƒ…æ„Ÿè¡¨è¾¾
{{OverBase64::technical;emotional::images/portrait.jpg}}
```

è¾“å‡º:
```
[å¤šåª’ä½“å†…å®¹åˆ†æç»“æœ]

æ–‡ä»¶: portrait.jpg
  [technical]: å›¾åƒåˆ†è¾¨ç‡ä¸º1920x1080ï¼Œè‰²å½©é¥±å’Œåº¦é€‚ä¸­ï¼Œå¯¹ç„¦æ¸…æ™°...
  [emotional]: ç…§ç‰‡ä¼ è¾¾å‡ºä¸€ç§æ¸©æš–ã€å¹³é™çš„æ°›å›´ï¼Œäººç‰©è¡¨æƒ…æŸ”å’Œ...
```

### ç¤ºä¾‹ 3: æ–‡ä»¶å¤¹æ‰¹é‡å¤„ç†ï¼ˆä½¿ç”¨ç¼“å­˜ï¼‰
```
ç”¨æˆ·æ¶ˆæ¯:
æ€»ç»“è¿™ä¸ªé¡¹ç›®æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰å›¾ç‰‡
{{OverBase64::summary::project/screenshots::cache}}
```

è¾“å‡º:
```
[å¤šåª’ä½“å†…å®¹åˆ†æç»“æœ]

æ–‡ä»¶: screen1.png
  [summary (ç¼“å­˜)]: åº”ç”¨ç¨‹åºçš„ç™»å½•ç•Œé¢
  
æ–‡ä»¶: screen2.png
  [summary]: ç”¨æˆ·è®¾ç½®é¢æ¿
  
æ–‡ä»¶: screen3.png
  [summary (ç¼“å­˜)]: æ•°æ®å¯è§†åŒ–å›¾è¡¨
```

### ç¤ºä¾‹ 4: å¤æ‚åœºæ™¯ - å¤šä¸ªæ–‡ä»¶å’Œé¢„è®¾
```
ç³»ç»Ÿæç¤ºè¯:
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„è§†è§‰å†…å®¹åˆ†æå¸ˆã€‚ä»¥ä¸‹æ˜¯éœ€è¦åˆ†æçš„ææ–™ï¼š

é¡¹ç›®æ¦‚è§ˆï¼š
{{OverBase64::summary::project/overview}}

è¯¦ç»†è®¾è®¡ç¨¿ï¼š
{{OverBase64::detailed;technical::project/designs/final.png::cache}}

å‚è€ƒè§†é¢‘ï¼š
{{OverBase64::summary::videos/reference.mp4}}
```

## å·¥ä½œæµç¨‹

1. **è¯­æ³•è§£æ**: æ’ä»¶æ‰«ææ¶ˆæ¯ä¸­çš„ `{{OverBase64::...}}` è¯­æ³•
2. **è·¯å¾„è§£æ**: 
   - æ£€æŸ¥æ˜¯å¦ä¸ºè·¯å¾„åˆ«å
   - è§£æä¸ºç»å¯¹è·¯å¾„æˆ–ç›¸å¯¹è·¯å¾„
   - åˆ¤æ–­æ˜¯æ–‡ä»¶è¿˜æ˜¯æ–‡ä»¶å¤¹
3. **æ–‡ä»¶å¤„ç†**:
   - å¦‚æœæ˜¯æ–‡ä»¶å¤¹ï¼Œæ‰«ææ‰€æœ‰æ”¯æŒçš„åª’ä½“æ–‡ä»¶
   - è¯»å–æ–‡ä»¶å¹¶è½¬æ¢ä¸º Base64 æ ¼å¼
   - è®¡ç®—æ–‡ä»¶å†…å®¹çš„ MD5 å“ˆå¸Œ
4. **ç¼“å­˜æ£€æŸ¥**:
   - å¦‚æœå¯ç”¨ç¼“å­˜ä¸”ç¼“å­˜å­˜åœ¨ï¼Œç›´æ¥ä½¿ç”¨ç¼“å­˜æè¿°
   - å¦åˆ™è°ƒç”¨å¤šæ¨¡æ€ API è·å–æ–°æè¿°
5. **é¢„è®¾å¤„ç†**:
   - æŒ‰é¡ºåºå¤„ç†æ¯ä¸ªé¢„è®¾
   - ä½¿ç”¨é¢„è®¾çš„ prompt å’Œå‚æ•°è°ƒç”¨ API
   - æ”¯æŒå¹¶å‘å¤„ç†ä»¥æé«˜æ•ˆç‡
6. **ç»“æœæ ¼å¼åŒ–**:
   - å°†æ‰€æœ‰é¢„è®¾çš„ç»“æœæ ¼å¼åŒ–ä¸ºç»“æ„åŒ–æ–‡æœ¬
   - æ ‡æ³¨å“ªäº›ç»“æœæ¥è‡ªç¼“å­˜
   - æ›¿æ¢åŸå§‹è¯­æ³•ä¸ºæ ¼å¼åŒ–ç»“æœ

## æ”¯æŒçš„åª’ä½“æ ¼å¼

- **å›¾åƒ**: `.jpg`, `.jpeg`, `.png`, `.gif`, `.webp`
- **è§†é¢‘**: `.mp4`
- **éŸ³é¢‘**: `.mp3`, `.wav`

## æ€§èƒ½ä¼˜åŒ–

1. **æ™ºèƒ½ç¼“å­˜**: åŸºäºå†…å®¹å“ˆå¸Œçš„ç¼“å­˜é¿å…é‡å¤å¤„ç†
2. **å¹¶å‘æ§åˆ¶**: å¯é…ç½®çš„å¼‚æ­¥å¹¶å‘æ•°é‡ï¼ˆ`MultiModalModelAsynchronousLimit`ï¼‰
3. **æ‰¹é‡å¤„ç†**: ä¸€æ¬¡è¯­æ³•å¯å¤„ç†æ•´ä¸ªæ–‡ä»¶å¤¹
4. **å¢é‡æ›´æ–°**: åªæœ‰æ–‡ä»¶å†…å®¹å˜åŒ–æ—¶æ‰é‡æ–°å¤„ç†

## æ³¨æ„äº‹é¡¹

1. **è·¯å¾„åˆ«åä¼˜å…ˆ**: å¦‚æœè·¯å¾„å¼€å¤´åŒ¹é…åˆ«åï¼Œå°†ä¼˜å…ˆä½¿ç”¨åˆ«åæ˜ å°„
2. **é¢„è®¾æ•°é‡é™åˆ¶**: æœ€å¤šæ”¯æŒ 5 ä¸ªé¢„è®¾ç»„åˆ
3. **ç¼“å­˜æŒä¹…åŒ–**: ç¼“å­˜ä¼šè‡ªåŠ¨ä¿å­˜åˆ° `multimedia_cache.json`
4. **API è°ƒç”¨æˆæœ¬**: æœªä½¿ç”¨ç¼“å­˜æ—¶ï¼Œæ¯ä¸ªæ–‡ä»¶çš„æ¯ä¸ªé¢„è®¾éƒ½ä¼šè°ƒç”¨ä¸€æ¬¡ API
5. **æ–‡ä»¶å¤§å°**: æ³¨æ„ Base64 ç¼–ç åçš„æ•°æ®å¤§å°é™åˆ¶

## ä¸å…¶ä»–å¤šæ¨¡æ€å¤„ç†æ–¹å¼çš„åŒºåˆ«

### MultimediaProcessor vs ImageProcessor

| ç‰¹æ€§ | ImageProcessor | MultimediaProcessor |
|------|----------------|---------------------|
| è§¦å‘æ–¹å¼ | è‡ªåŠ¨å¤„ç†æ‰€æœ‰ Base64 | éœ€è¦æ˜ç¡®è¯­æ³• `{{OverBase64::...}}` |
| é¢„è®¾æ”¯æŒ | æ— ï¼Œä½¿ç”¨å…¨å±€é…ç½® | å®Œæ•´çš„é¢„è®¾ç³»ç»Ÿ |
| å¤šé¢„è®¾ç»„åˆ | ä¸æ”¯æŒ | æ”¯æŒæœ€å¤š 5 ä¸ªé¢„è®¾ |
| æ–‡ä»¶å¤¹å¤„ç† | ä¸æ”¯æŒ | å®Œå…¨æ”¯æŒ |
| è·¯å¾„åˆ«å | ä¸æ”¯æŒ | å®Œå…¨æ”¯æŒ |
| ç¼“å­˜æ§åˆ¶ | è‡ªåŠ¨ç¼“å­˜ | é»˜è®¤ç¼“å­˜ï¼ˆå¯ç”¨ `::no_cache` ç¦ç”¨ï¼‰ |
| æ‰¹é‡å¤„ç† | ä¸æ”¯æŒ | å®Œå…¨æ”¯æŒ |
| å¤„ç†æ–¹å¼ | ç¿»è¯‘ä¸ºæ–‡æœ¬æè¿° | ç¿»è¯‘ä¸ºæ–‡æœ¬æè¿° |

### MultimediaProcessor vs `{{ShowBase64::path}}` vs `{{ShowBase64+::~}}`

| ç‰¹æ€§ | `{{ShowBase64::path}}` | `{{OverBase64::...}}` | `{{ShowBase64+::...}}` |
|------|------------------------|----------------------|------------------------|
| è§¦å‘æ–¹å¼ | `{{ShowBase64::path}}` | `{{OverBase64::preset::path}}` | `{{ShowBase64+::preset::path}}` |
| å¤„ç†æ–¹å¼ | **ä»…å‘é€åŸå§‹ Base64** | **ä»…æ–‡æœ¬æè¿°** | **æè¿° + åŸå§‹ Base64** |
| é¢„è®¾æ”¯æŒ | âŒ ä¸æ”¯æŒ | âœ… æ”¯æŒå¤šé¢„è®¾ç»„åˆ | âœ… æ”¯æŒå¤šé¢„è®¾ç»„åˆ |
| ç¼“å­˜æœºåˆ¶ | âŒ æ— ç¼“å­˜ | âœ… æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ | âœ… æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿ |
| è·¯å¾„åˆ«å | âœ… å®Œå…¨æ”¯æŒ | âœ… å®Œå…¨æ”¯æŒ | âœ… å®Œå…¨æ”¯æŒ |
| æ–‡ä»¶å¤¹å¤„ç† | âœ… å®Œå…¨æ”¯æŒ | âœ… å®Œå…¨æ”¯æŒ | âœ… å®Œå…¨æ”¯æŒ |
| Ignore æ–‡ä»¶æ”¯æŒ | `.showbase64ignore` | `.overbase64ignore` | `.showbase64plusignore` |
| é€‚ç”¨åœºæ™¯ | LLM åŸç”Ÿå¤šæ¨¡æ€ | çº¯æ–‡æœ¬æè¿° | **å®Œæ•´ä½“éªŒ** |
| API æ¶ˆè€— | ä»…ä¸»å¯¹è¯ | ä¸»å¯¹è¯ + ç¿»è¯‘ API | ä¸»å¯¹è¯ + ç¿»è¯‘ API |
| æ€§èƒ½ | æœ€å¿« | ä¸­ç­‰ | ä¸­ç­‰ |
| æ¨¡å‹è¦æ±‚ | å¿…é¡»æ”¯æŒå¤šæ¨¡æ€ | ä»»æ„æ–‡æœ¬æ¨¡å‹ | å¿…é¡»æ”¯æŒå¤šæ¨¡æ€ |
| ä¿¡æ¯å®Œæ•´åº¦ | ä»…åŸå§‹å†…å®¹ | ä»…æ–‡æœ¬æè¿° | **æè¿° + åŸå§‹å†…å®¹** |

### ä½¿ç”¨å»ºè®®

**ä½¿ç”¨ `{{ShowBase64::path}}`ï¼š**
- âœ… æ¨¡å‹åŸç”Ÿæ”¯æŒå¤šæ¨¡æ€ï¼ˆGPT-4V, Claude 3, Gemini Pro Visionï¼‰
- âœ… åªéœ€è¦æ¨¡å‹ç›´æ¥"çœ‹åˆ°"åŸå§‹å›¾åƒ/è§†é¢‘ï¼Œä¸éœ€è¦é¢„å…ˆæè¿°
- âœ… è¿½æ±‚æœ€å¿«å“åº”é€Ÿåº¦
- âœ… èŠ‚çœ API æˆæœ¬ï¼ˆæ— éœ€é¢å¤–ç¿»è¯‘è°ƒç”¨ï¼‰
- âœ… å›ºå®šçš„è¡¨æƒ…åŒ…é›†åˆã€UI æˆªå›¾ç­‰ç®€å•åœºæ™¯

**ä½¿ç”¨ `{{OverBase64::preset::path}}`ï¼š**
- âœ… åªéœ€è¦æ–‡æœ¬æè¿°ï¼Œä¸éœ€è¦å‘é€åŸå§‹å¤šæ¨¡æ€å†…å®¹
- âœ… éœ€è¦ç‰¹å®šè§’åº¦çš„æ–‡æœ¬æè¿°ï¼ˆæŠ€æœ¯åˆ†æã€æƒ…æ„Ÿåˆ†æã€åˆ›æ„æè¿°ç­‰ï¼‰
- âœ… éœ€è¦å¤šä¸ªä¸åŒè§†è§’çš„åˆ†æç»“æœ
- âœ… åˆ©ç”¨ç¼“å­˜é¿å…é‡å¤åˆ†æ
- âœ… æ¨¡å‹ä¸æ”¯æŒå¤šæ¨¡æ€è¾“å…¥
- âœ… éœ€è¦ç»“æ„åŒ–çš„æ–‡æœ¬è¾“å‡ºç”¨äºåç»­å¤„ç†

**ä½¿ç”¨ `{{ShowBase64+::preset::path}}`ï¼ˆæ¨èç”¨äºå¤æ‚åœºæ™¯ï¼‰ï¼š**
- âœ… éœ€è¦ LLM åŒæ—¶ç†è§£æ–‡æœ¬æè¿°å’ŒåŸå§‹å¤šæ¨¡æ€å†…å®¹
- âœ… å¤æ‚çš„å¤šæ¨¡æ€ç†è§£ä»»åŠ¡ï¼ˆåŒ»ç–—è¯Šæ–­ã€è®¾è®¡è¯„å®¡ã€ä»£ç å®¡æŸ¥ç­‰ï¼‰
- âœ… éœ€è¦å¤šè§’åº¦é¢„è®¾åˆ†æ + åŸå§‹å†…å®¹éªŒè¯
- âœ… å……åˆ†åˆ©ç”¨ç¼“å­˜èŠ‚çœç¿»è¯‘ API æˆæœ¬
- âœ… æ¨¡å‹æ”¯æŒå¤šæ¨¡æ€ï¼Œä¸”éœ€è¦æœ€å®Œæ•´çš„ä¿¡æ¯
- âœ… æ•™è‚²ã€å’¨è¯¢ç­‰éœ€è¦è¯¦ç»†è§£é‡Šçš„åœºæ™¯

**ä¸‰è€…å…±äº«çš„èƒ½åŠ›ï¼š**
- âœ… è·¯å¾„åˆ«åç³»ç»Ÿï¼ˆ`path-aliases.json`ï¼‰
- âœ… æ–‡ä»¶å¤¹æ‰¹é‡å¤„ç†
- âœ… ä¸“ç”¨å¿½ç•¥æ–‡ä»¶æœºåˆ¶ï¼ˆ`.showbase64ignore` / `.overbase64ignore` / `.showbase64plusignore`ï¼‰
- âœ… æ·±å±‚è·¯å¾„æ”¯æŒ
- âœ… ç›¸å¯¹è·¯å¾„å’Œç»å¯¹è·¯å¾„

**æ€§èƒ½ä¸æˆæœ¬å¯¹æ¯”ï¼š**
- `{{ShowBase64::path}}`ï¼šæœ€å¿«ï¼Œæˆæœ¬æœ€ä½ï¼ˆæ— ç¿»è¯‘ APIï¼‰
- `{{OverBase64::...}}`ï¼šä¸­ç­‰é€Ÿåº¦ï¼Œä¸­ç­‰æˆæœ¬ï¼ˆéœ€ç¿»è¯‘ APIï¼‰
- `{{ShowBase64+::...}}`ï¼šä¸­ç­‰é€Ÿåº¦ï¼Œä¸­ç­‰æˆæœ¬ï¼ˆéœ€ç¿»è¯‘ APIï¼‰ï¼Œä½†ä¿¡æ¯æœ€å®Œæ•´

## é«˜çº§æŠ€å·§

### 1. åˆ›å»ºä¸“ç”¨é¢„è®¾
æ ¹æ®ä¸åŒçš„ä½¿ç”¨åœºæ™¯åˆ›å»ºä¸“ç”¨é¢„è®¾ï¼Œä¾‹å¦‚ï¼š
- `code_screenshot`: ä¸“é—¨åˆ†æä»£ç æˆªå›¾
- `ui_design`: ä¸“é—¨åˆ†æ UI è®¾è®¡ç¨¿
- `documentation`: ä¸“é—¨ä¸ºæ–‡æ¡£å›¾ç‰‡ç”Ÿæˆè¯´æ˜

### 2. é¢„è®¾ç»„åˆç­–ç•¥
åˆç†ç»„åˆé¢„è®¾å¯ä»¥è·å¾—æ›´å…¨é¢çš„åˆ†æï¼š
- `summary;detailed`: å…ˆæ¦‚æ‹¬å†è¯¦è¿°
- `technical;emotional`: æŠ€æœ¯å’Œè‰ºæœ¯åŒé‡è§†è§’
- `default;custom`: é€šç”¨+ç‰¹å®šéœ€æ±‚

### 3. ç¼“å­˜ç®¡ç†
- **é»˜è®¤å¯ç”¨ç¼“å­˜**ï¼Œå¤§å¤šæ•°åœºæ™¯æ— éœ€é¢å¤–é…ç½®
- å¼€å‘æ—¶ä½¿ç”¨ `::no_cache` ä»¥è·å–æœ€æ–°ç»“æœ
- ç”Ÿäº§ç¯å¢ƒä½¿ç”¨é»˜è®¤ç¼“å­˜ä»¥èŠ‚çœ API æˆæœ¬å’Œæé«˜é€Ÿåº¦
- å®šæœŸæ¸…ç†è¿‡æœŸç¼“å­˜ï¼ˆå¯æ‰‹åŠ¨åˆ é™¤ `multimedia_cache.json` ä¸­çš„æ—§æ¡ç›®ï¼‰

## æ•…éšœæ’æŸ¥

### é—®é¢˜ 1: è·¯å¾„åˆ«åä¸å·¥ä½œ
- æ£€æŸ¥ `path-aliases.json` æ˜¯å¦å­˜åœ¨ä¸”æ ¼å¼æ­£ç¡®
- ç¡®è®¤åˆ«åè·¯å¾„æ˜¯å¦ä»¥åˆ«åå¼€å¤´
- æŸ¥çœ‹è°ƒè¯•æ—¥å¿—ï¼ˆå¼€å¯ `DebugMode=true`ï¼‰

### é—®é¢˜ 2: æ— æ³•è¯»å–æ–‡ä»¶
- ç¡®è®¤è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼ˆæ³¨æ„æ“ä½œç³»ç»Ÿçš„è·¯å¾„åˆ†éš”ç¬¦ï¼‰
- æ£€æŸ¥æ–‡ä»¶æƒé™
- å°è¯•ä½¿ç”¨ç»å¯¹è·¯å¾„æµ‹è¯•

### é—®é¢˜ 3: ç¼“å­˜æœªæŒ‰é¢„æœŸå·¥ä½œ
- **é»˜è®¤å°±å¯ç”¨ç¼“å­˜**ï¼Œæ— éœ€æ·»åŠ  `::cache`
- å¦‚æœéœ€è¦ç¦ç”¨ç¼“å­˜ï¼Œä½¿ç”¨ `::no_cache` è¯­æ³•
- æ£€æŸ¥æ–‡ä»¶å†…å®¹æ˜¯å¦æ”¹å˜ï¼ˆæ”¹å˜åå“ˆå¸Œä¼šä¸åŒï¼Œä¼šè‡ªåŠ¨é‡æ–°ç”Ÿæˆï¼‰

## ç¼“å­˜æœºåˆ¶è¯¦è§£

ç¼“å­˜æ–‡ä»¶ä½äº `Plugin/MultimediaProcessor/multimedia_cache.json`ï¼Œé‡‡ç”¨ **v3.0 ä¼˜åŒ–ç‰ˆç¼“å­˜ç»“æ„**ã€‚

### ğŸ¯ æ ¸å¿ƒä¼˜åŒ–ï¼šé¿å… Base64 æ•°æ®å†—ä½™

**v3.0 çš„å…³é”®æ”¹è¿›**ï¼šä»¥æ–‡ä»¶ hash ä¸ºä¸»é”®ï¼ŒBase64 æ•°æ®åªå­˜å‚¨ä¸€æ¬¡ï¼Œä¸åŒé¢„è®¾çš„æè¿°ç»“æœå­˜å‚¨åœ¨ `descriptions` å­å¯¹è±¡ä¸­ã€‚

**ä¼˜åŠ¿**ï¼š
- âœ… **å¤§å¹…èŠ‚çœå­˜å‚¨ç©ºé—´**ï¼šåŒä¸€æ–‡ä»¶ç”¨å¤šä¸ªé¢„è®¾å¤„ç†æ—¶ï¼ŒBase64 æ•°æ®ä¸ä¼šé‡å¤å­˜å‚¨
- âœ… **ç»Ÿä¸€æ–‡ä»¶ç®¡ç†**ï¼šåŒä¸€æ–‡ä»¶çš„æ‰€æœ‰ä¿¡æ¯é›†ä¸­åœ¨ä¸€ä¸ªæ¡ç›®ä¸­
- âœ… **è·¯å¾„è¿½è¸ª**ï¼šè®°å½•æ–‡ä»¶è¢«å¼•ç”¨çš„æ‰€æœ‰è·¯å¾„å†å²
- âœ… **é¢„è®¾éš”ç¦»**ï¼šæ¯ä¸ªé¢„è®¾çš„æè¿°ç»“æœç‹¬ç«‹å­˜å‚¨ï¼Œäº’ä¸å¹²æ‰°

### ç¼“å­˜é”®æ ¼å¼

**v3.0 æ–°æ ¼å¼**ï¼šç›´æ¥ä½¿ç”¨æ–‡ä»¶çš„ MD5 hash ä½œä¸ºä¸»é”®
```
{MD5_HASH}
```

ä¾‹å¦‚ï¼š`a1b2c3d4e5f6789abcdef0123456789`

### å®Œæ•´ç¼“å­˜æ•°æ®ç»“æ„ï¼ˆv3.0ï¼‰

```json
{
  "a1b2c3d4e5f6789abcdef0123456789": {
    // === åŸºæœ¬æ ‡è¯†ä¿¡æ¯ ===
    "id": "550e8400-e29b-41d4-a716-446655440000",
    "hash": "a1b2c3d4e5f6789abcdef0123456789",
    "cacheVersion": "3.0",
    
    // === åª’ä½“æ•°æ®ï¼ˆåªå­˜å‚¨ä¸€æ¬¡ï¼‰===
    "mimeType": "image/jpeg",
    "base64Data": "/9j/4AAQSkZJRgABAQAA...",
    "fileSize": 245760,
    
    // === è·¯å¾„ä¿¡æ¯æ•°ç»„ï¼ˆè®°å½•æ‰€æœ‰å¼•ç”¨è·¯å¾„ï¼‰===
    "paths": [
      {
        "originalPath": "@hornet/example.jpg",
        "resolvedPath": "/Users/username/Pictures/Hornetè¡¨æƒ…åŒ…/example.jpg",
        "usedAlias": true,
        "aliasName": "@hornet",
        "isFolder": false,
        "folderPath": null,
        "batchId": "7c9e6679-7425-40de-944b-e07fc1f90ae7",
        "groupId": "def456abc789xyz123456789abcdef01",
        "fileIndex": 0,
        "totalFiles": 1,
        "lastUsed": "2024-01-15T08:30:00.000Z"
      }
    ],
    
    // === æ—¶é—´ä¿¡æ¯ ===
    "createdTime": "2024-01-01T12:00:00.000Z",
    "lastAccessTime": "2024-01-20T14:22:00.000Z",
    
    // === ä¸åŒé¢„è®¾çš„æè¿°ç»“æœ ===
    "descriptions": {
      "technical": {
        "description": "è¿™æ˜¯ä¸€å¼ é«˜è´¨é‡çš„è§’è‰²è¡¨æƒ…åŒ…å›¾ç‰‡...",
        "descriptionLength": 89,
        "presetConfig": {
          "model": "gpt-4o",
          "temperature": 0.3,
          "maxTokens": 2000,
          "topP": 0.9,
          "thinkingBudget": null
        },
        "createdTime": "2024-01-01T12:00:00.000Z",
        "lastAccessTime": "2024-01-15T08:30:00.000Z",
        "accessCount": 15
      },
      "detailed": {
        "description": "ä¸€å¼ å¯çˆ±çš„è§’è‰²è¡¨æƒ…åŒ…ã€‚ç”»é¢ä¸­çš„è§’è‰²åŒçœ¼é—ªäº®...",
        "descriptionLength": 112,
        "presetConfig": {
          "model": "gpt-4-vision-preview",
          "temperature": 0.7,
          "maxTokens": 2000,
          "topP": 1.0,
          "thinkingBudget": 0
        },
        "createdTime": "2024-01-03T10:15:00.000Z",
        "lastAccessTime": "2024-01-20T14:22:00.000Z",
        "accessCount": 8
      }
    }
  }
}
```

### ç¼“å­˜å…ƒæ•°æ®å­—æ®µè¯´æ˜

#### ğŸ”‘ åŸºæœ¬æ ‡è¯†
- **`id`**: å”¯ä¸€ UUID æ ‡è¯†ç¬¦ï¼Œæ¯ä¸ªæ–‡ä»¶çš„å…¨å±€å”¯ä¸€ ID
- **`hash`**: åª’ä½“å†…å®¹çš„ MD5 å“ˆå¸Œå€¼ï¼ˆåŸºäº Base64 æ•°æ®è®¡ç®—ï¼‰
- **`cacheVersion`**: ç¼“å­˜æ ¼å¼ç‰ˆæœ¬å·ï¼ˆå½“å‰ä¸º 3.0ï¼‰

#### ğŸ“¦ åª’ä½“æ•°æ®ï¼ˆåªå­˜å‚¨ä¸€æ¬¡ï¼‰
- **`mimeType`**: MIME ç±»å‹ï¼ˆå¦‚ `image/jpeg`, `video/mp4`ï¼‰
- **`base64Data`**: **å®Œæ•´çš„ Base64 ç¼–ç æ•°æ®**ï¼ˆä¸å«å‰ç¼€ï¼‰ï¼Œæ‰€æœ‰é¢„è®¾å…±äº«
- **`fileSize`**: ä¼°ç®—çš„åŸå§‹æ–‡ä»¶å¤§å°ï¼ˆå­—èŠ‚ï¼‰

#### ğŸ“‚ è·¯å¾„ä¿¡æ¯æ•°ç»„
`paths` æ•°ç»„è®°å½•è¯¥æ–‡ä»¶è¢«å¼•ç”¨çš„æ‰€æœ‰è·¯å¾„ï¼Œæ¯ä¸ªè·¯å¾„åŒ…å«ï¼š
- **`originalPath`**: ç”¨æˆ·è¾“å…¥çš„åŸå§‹è·¯å¾„ï¼ˆå«åˆ«åï¼‰

### v3.0 vs v2.0 å¯¹æ¯”

| ç‰¹æ€§ | v2.0 | v3.0 |
|------|------|------|
| ç¼“å­˜é”® | `{hash}_{preset}` | `{hash}` |
| Base64 å­˜å‚¨ | æ¯ä¸ªé¢„è®¾é‡å¤å­˜å‚¨ | åªå­˜å‚¨ä¸€æ¬¡ |
| ç©ºé—´æ•ˆç‡ | ä½ï¼ˆå¤§é‡å†—ä½™ï¼‰ | é«˜ï¼ˆæ— å†—ä½™ï¼‰ |
| è·¯å¾„è¿½è¸ª | å•ä¸€è·¯å¾„ | å¤šè·¯å¾„æ•°ç»„ |
| é¢„è®¾ç®¡ç† | åˆ†æ•£åœ¨å¤šä¸ªæ¡ç›® | é›†ä¸­åœ¨ descriptions |
| æŸ¥è¯¢æ•ˆç‡ | éœ€è¦éå†å¤šä¸ªé”® | ç›´æ¥é€šè¿‡ hash è®¿é—® |
| å­˜å‚¨ç¤ºä¾‹ | åŒä¸€æ–‡ä»¶3ä¸ªé¢„è®¾ = 3ä»½Base64 | åŒä¸€æ–‡ä»¶3ä¸ªé¢„è®¾ = 1ä»½Base64 |

- **`resolvedPath`**: è§£æåçš„å®é™…æ–‡ä»¶ç³»ç»Ÿè·¯å¾„
- **`usedAlias`**: æ˜¯å¦ä½¿ç”¨äº†è·¯å¾„åˆ«å
- **`aliasName`**: ä½¿ç”¨çš„åˆ«ååç§°
- **`isFolder`**: æ˜¯å¦å±äºæ–‡ä»¶å¤¹æ‰¹é‡å¤„ç†
- **`folderPath`**: æ‰€å±æ–‡ä»¶å¤¹è·¯å¾„
- **`batchId`**: æ‰¹æ¬¡å”¯ä¸€æ ‡è¯†ï¼ˆUUIDï¼‰
- **`groupId`**: ç»„åˆå”¯ä¸€å“ˆå¸Œæ ‡è¯†
- **`fileIndex`**: åœ¨ç»„åˆä¸­çš„ç´¢å¼•ä½ç½®
- **`totalFiles`**: è¯¥ç»„åˆåŒ…å«çš„æ–‡ä»¶æ€»æ•°
- **`lastUsed`**: è¯¥è·¯å¾„æœ€åä½¿ç”¨æ—¶é—´

#### ğŸ“ æè¿°ç»“æœå¯¹è±¡
`descriptions` å¯¹è±¡ä»¥é¢„è®¾åç§°ä¸ºé”®ï¼Œå­˜å‚¨æ¯ä¸ªé¢„è®¾çš„å¤„ç†ç»“æœï¼š
- **`description`**: æè¿°æ–‡æœ¬å†…å®¹
- **`descriptionLength`**: æè¿°é•¿åº¦
- **`presetConfig`**: ä½¿ç”¨çš„é¢„è®¾é…ç½®ï¼ˆmodel, temperature, maxTokens, topP, thinkingBudgetï¼‰
- **`createdTime`**: é¦–æ¬¡åˆ›å»ºæ—¶é—´
- **`lastAccessTime`**: æœ€åè®¿é—®æ—¶é—´
- **`accessCount`**: ç´¯è®¡è®¿é—®æ¬¡æ•°

#### ğŸ“Š æ–‡ä»¶çº§æ—¶é—´ä¿¡æ¯
- **`createdTime`**: æ–‡ä»¶é¦–æ¬¡è¢«å¤„ç†çš„æ—¶é—´
- **`lastAccessTime`**: æ–‡ä»¶æœ€åè¢«è®¿é—®çš„æ—¶é—´ï¼ˆä»»ä½•é¢„è®¾ï¼‰

### ç¼“å­˜ä½¿ç”¨åœºæ™¯

#### 1. æŸ¥æ‰¾æ–‡ä»¶çš„æ‰€æœ‰é¢„è®¾æè¿°
```javascript
// ç›´æ¥é€šè¿‡ hash è·å–æ‰€æœ‰é¢„è®¾ç»“æœ
const fileHash = 'a1b2c3d4e5f6789abcdef0123456789';
const fileCache = mediaCache[fileHash];
const allDescriptions = fileCache.descriptions;
// è¾“å‡º: { technical: {...}, detailed: {...}, emotional: {...} }
```

#### 2. æ·»åŠ æ–°é¢„è®¾æè¿°ï¼ˆæ— éœ€é‡å¤å­˜å‚¨ Base64ï¼‰
```javascript
// åœ¨å·²å­˜åœ¨çš„æ–‡ä»¶è®°å½•ä¸­æ·»åŠ æ–°é¢„è®¾
mediaCache[fileHash].descriptions['newPreset'] = {
  description: '...',
  presetConfig: {...},
  createdTime: new Date().toISOString(),
  lastAccessTime: new Date().toISOString(),
  accessCount: 1
};
```

#### 3. è¿½è¸ªæ–‡ä»¶å¼•ç”¨è·¯å¾„
```javascript
// æŸ¥çœ‹æ–‡ä»¶è¢«å“ªäº›è·¯å¾„å¼•ç”¨è¿‡
const paths = mediaCache[fileHash].paths;
paths.forEach(p => {
  console.log(`è·¯å¾„: ${p.originalPath}, æœ€åä½¿ç”¨: ${p.lastUsed}`);
});
```

#### 4. Base64 å¤ç”¨ï¼ˆæ‰€æœ‰é¢„è®¾å…±äº«ï¼‰
```javascript
// ç›´æ¥è¯»å–æ–‡ä»¶çš„ Base64ï¼Œç”¨äºä»»ä½•é¢„è®¾
const base64Data = mediaCache[fileHash].base64Data;
const mimeType = mediaCache[fileHash].mimeType;
// æ— éœ€é‡æ–°è¯»å–æ–‡ä»¶
```

#### 5. ç»Ÿè®¡ç©ºé—´èŠ‚çœ
```javascript
// è®¡ç®—å¦‚æœç”¨ v2.0 ä¼šæµªè´¹å¤šå°‘ç©ºé—´
Object.values(mediaCache).forEach(file => {
  const presetCount = Object.keys(file.descriptions).length;
  const savedSpace = file.fileSize * (presetCount - 1);
  console.log(`æ–‡ä»¶ ${file.hash.substring(0,8)}: èŠ‚çœäº† ${savedSpace} å­—èŠ‚`);
});
```

### ç¼“å­˜ä¼˜åŠ¿ï¼ˆv3.0ï¼‰

- âœ… **å¤§å¹…èŠ‚çœå­˜å‚¨ç©ºé—´**ï¼šBase64 æ•°æ®åªå­˜å‚¨ä¸€æ¬¡ï¼Œé¿å…é‡å¤ï¼ˆå…³é”®ä¼˜åŒ–ï¼ï¼‰
- âœ… **ç»Ÿä¸€æ–‡ä»¶ç®¡ç†**ï¼šåŒä¸€æ–‡ä»¶çš„æ‰€æœ‰ä¿¡æ¯é›†ä¸­ç®¡ç†
- âœ… **é¿å…é‡å¤è°ƒç”¨ API**ï¼šç›¸åŒå†…å®¹å’Œé¢„è®¾ç›´æ¥ä½¿ç”¨ç¼“å­˜
- âœ… **å¿«é€Ÿå“åº”**ï¼šæ— éœ€ç­‰å¾… API è°ƒç”¨
- âœ… **èŠ‚çœæˆæœ¬**ï¼šå‡å°‘ API è°ƒç”¨è´¹ç”¨
- âœ… **å®Œæ•´è¿½æº¯**ï¼šä¿å­˜å®Œæ•´çš„å¤„ç†ä¸Šä¸‹æ–‡å’Œå…ƒæ•°æ®
- âœ… **å¤šè·¯å¾„è¿½è¸ª**ï¼šè®°å½•æ–‡ä»¶è¢«å¼•ç”¨çš„æ‰€æœ‰è·¯å¾„
- âœ… **é¢„è®¾çµæ´»æ€§**ï¼šè½»æ¾æ·»åŠ æ–°é¢„è®¾æè¿°ï¼Œæ— éœ€é‡å¤å­˜å‚¨åª’ä½“æ•°æ®
- âœ… **ç»Ÿè®¡åˆ†æ**ï¼šè®¿é—®æ¬¡æ•°ã€æ—¶é—´ç­‰ç»Ÿè®¡ä¿¡æ¯
- âœ… **æ‰¹é‡ç®¡ç†**ï¼šé€šè¿‡ batchId å’Œ groupId ç®¡ç†æ‰¹é‡å¤„ç†ç»“æœ

**ç©ºé—´èŠ‚çœç¤ºä¾‹**ï¼š
- ä¸€ä¸ª 2MB çš„å›¾ç‰‡ç”¨ 3 ä¸ªé¢„è®¾å¤„ç†
- v2.0: å­˜å‚¨ 3 æ¬¡ Base64 = 6MB
- v3.0: å­˜å‚¨ 1 æ¬¡ Base64 = 2MB
- èŠ‚çœ: 4MB (67%)

### ç¼“å­˜ç®¡ç†å»ºè®®

1. **å®šæœŸæ¸…ç†**ï¼šåˆ é™¤ `lastAccessTime` è¶…è¿‡ 30 å¤©ä¸” `accessCount` è¾ƒä½çš„è®°å½•
2. **å¤§å°æ§åˆ¶**ï¼šç›‘æ§ `multimedia_cache.json` æ–‡ä»¶å¤§å°ï¼Œè¶…è¿‡ä¸€å®šé˜ˆå€¼æ—¶æ¸…ç†
3. **å¤‡ä»½ç­–ç•¥**ï¼šå®šæœŸå¤‡ä»½ç¼“å­˜æ–‡ä»¶ï¼Œé¿å…ä¸¢å¤±å†å²æ•°æ®
4. **ç‰ˆæœ¬è¿ç§»**ï¼šæ—§ç‰ˆæœ¬ç¼“å­˜ï¼ˆæ—  `cacheVersion` å­—æ®µï¼‰å¯æ‰‹åŠ¨åˆ é™¤æˆ–è¿ç§»

### ç¼“å­˜æŸ¥è¯¢ç¤ºä¾‹ï¼ˆv3.0ï¼‰

#### æŸ¥æ‰¾ç‰¹å®šæ–‡ä»¶çš„æ‰€æœ‰é¢„è®¾æè¿°
```javascript
// ç›´æ¥é€šè¿‡ hash è®¿é—®
const fileHash = 'a1b2c3d4e5f6789abcdef0123456789';
const file = mediaCache[fileHash];

// åˆ—å‡ºæ‰€æœ‰é¢„è®¾åŠå…¶æè¿°
Object.entries(file.descriptions).forEach(([preset, info]) => {
  console.log(`${preset}: ${info.description.substring(0, 50)}...`);
  console.log(`  è®¿é—®æ¬¡æ•°: ${info.accessCount}`);
});
```

#### æŸ¥æ‰¾ä½¿ç”¨ç‰¹å®šé¢„è®¾çš„æ‰€æœ‰æ–‡ä»¶
```javascript
// æŸ¥æ‰¾æ‰€æœ‰ä½¿ç”¨ 'technical' é¢„è®¾çš„æ–‡ä»¶
const filesWithTechnical = Object.entries(mediaCache)
  .filter(([hash, file]) => file.descriptions.technical)
  .map(([hash, file]) => ({
    hash: hash.substring(0, 8),
    description: file.descriptions.technical.description,
    accessCount: file.descriptions.technical.accessCount
  }));
```

#### æŸ¥æ‰¾ç‰¹å®šæ‰¹æ¬¡çš„æ‰€æœ‰æ–‡ä»¶
```javascript
// å‡è®¾ batchId ä¸º 7c9e6679-7425-40de-944b-e07fc1f90ae7
const batchFiles = Object.entries(mediaCache)
  .filter(([hash, file]) => 
    file.paths.some(p => p.batchId === '7c9e6679-7425-40de-944b-e07fc1f90ae7')
  )
  .map(([hash, file]) => {
    const pathInfo = file.paths.find(p => p.batchId === '7c9e6679-7425-40de-944b-e07fc1f90ae7');
    return { hash, fileIndex: pathInfo.fileIndex, file };
  })
  .sort((a, b) => a.fileIndex - b.fileIndex);
```

#### ç»Ÿè®¡æœ€å¸¸ç”¨çš„é¢„è®¾
```javascript
const presetStats = {};
Object.values(mediaCache).forEach(file => {
  Object.entries(file.descriptions).forEach(([preset, info]) => {
    if (!presetStats[preset]) {
      presetStats[preset] = { count: 0, totalAccess: 0 };
    }
    presetStats[preset].count++;
    presetStats[preset].totalAccess += info.accessCount;
  });
});
console.log(presetStats);
// è¾“å‡º: { technical: { count: 50, totalAccess: 320 }, ... }
```

#### è®¡ç®—å­˜å‚¨ç©ºé—´èŠ‚çœ
```javascript
let totalSaved = 0;
Object.values(mediaCache).forEach(file => {
  const presetCount = Object.keys(file.descriptions).length;
  if (presetCount > 1) {
    const saved = file.fileSize * (presetCount - 1);
    totalSaved += saved;
    console.log(`${file.hash.substring(0,8)}: ${presetCount}ä¸ªé¢„è®¾, èŠ‚çœ ${(saved/1024/1024).toFixed(2)}MB`);
  }
});
console.log(`æ€»å…±èŠ‚çœ: ${(totalSaved/1024/1024).toFixed(2)}MB`);
```
- æŸ¥çœ‹ `multimedia_cache.json` 