<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>工具列表配置编辑器</title>
    <link rel="stylesheet" href="tool_list_editor_new.css">
    <script>
        // 监听来自父窗口的主题变化消息
        window.addEventListener('message', (event) => {
            if (event.data && event.data.type === 'themeChange') {
                const theme = event.data.theme;
                document.documentElement.setAttribute('data-theme', theme);
            }
        });

        // 页面加载时，向父窗口请求当前主题
        window.addEventListener('DOMContentLoaded', () => {
            if (window.parent && window.parent !== window) {
                window.parent.postMessage({ type: 'requestTheme', for: 'tool_list_editor' }, '*');
            } else {
                // 如果是独立打开，则应用本地存储的主题或默认主题
                const storedTheme = localStorage.getItem('theme');
                const prefersDarkScheme = window.matchMedia("(prefers-color-scheme: dark)");
                if (storedTheme) {
                    document.documentElement.setAttribute('data-theme', storedTheme);
                } else {
                    document.documentElement.setAttribute('data-theme', prefersDarkScheme.matches ? 'dark' : 'light');
                }
            }
        });
    </script>
</head>
<body>
    <div class="container">
        <!-- 顶部标题栏 -->
        <header class="page-header">
            <h1>🛠️ 工具列表配置编辑器</h1>
            <p class="description">快速制作工具列表配置文件，用于Agent的提示词中</p>
        </header>
        
        <!-- 主要内容区 - 左右分栏布局 -->
        <div class="main-content">
            <!-- 左侧：工具选择区 -->
            <div class="left-panel">
                <!-- 过滤和搜索 -->
                <div class="filter-section">
                    <input type="search" id="tool-search" placeholder="🔍 搜索工具...">
                    <div class="filter-actions">
                        <label class="checkbox-label">
                            <input type="checkbox" id="show-selected-only">
                            <span>只显示已选</span>
                        </label>
                        <button id="select-all-btn" class="btn-secondary">全选</button>
                        <button id="deselect-all-btn" class="btn-secondary">清空</button>
                    </div>
                </div>

                <!-- 工具列表 -->
                <div class="tools-container">
                    <h2>可用工具 <span id="tool-count">(加载中...)</span></h2>
                    <div id="tools-list" class="tools-list">
                        <!-- 工具项将动态加载 -->
                    </div>
                </div>
            </div>

            <!-- 右侧：配置和预览区 -->
            <div class="right-panel">
                <!-- 配置文件管理 -->
                <div class="config-manager">
                    <h2>📁 配置管理</h2>
                    <div class="config-selector">
                        <select id="config-file-select">
                            <option value="">-- 新建配置文件 --</option>
                        </select>
                        <input type="text" id="new-config-name" placeholder="输入配置文件名..." style="display: none;">
                    </div>
                    
                    <div class="config-actions">
                        <button id="load-config-btn" class="btn-primary">加载</button>
                        <button id="create-config-btn" class="btn-primary">新建</button>
                        <button id="delete-config-btn" class="btn-danger" disabled>删除</button>
                        <button id="save-config-btn" class="btn-success" disabled>💾 保存</button>
                    </div>
                    
                    <span id="config-status" class="status-message"></span>
                </div>

                <!-- 预览区域 -->
                <div class="preview-section">
                    <h2>📝 生成预览</h2>
                    <div class="preview-controls">
                        <label class="checkbox-label">
                            <input type="checkbox" id="include-header" checked>
                            <span>包含文件头</span>
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="include-examples" checked>
                            <span>包含示例</span>
                        </label>
                        <button id="copy-preview-btn" class="btn-copy">📋 复制</button>
                        <button id="export-txt-btn" class="btn-export" disabled>📤 导出TXT</button>
                    </div>
                    <textarea id="preview-output" readonly placeholder="选择工具后将在此显示配置内容..."></textarea>
                </div>
            </div>
        </div>
    </div>

    <div id="loading-overlay" class="loading-overlay" style="display: none;">
        <div class="spinner"></div>
        <p>正在加载...</p>
    </div>

    <script src="tool_list_editor.js"></script>
</body>
</html>
